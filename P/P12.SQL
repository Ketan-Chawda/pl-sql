DECLARE
	CURSOR P12_CURSOR
	IS SELECT RNO,BOOKNO,ISSUEDATE,RETURNDATE
	FROM ISSUE
	WHERE RETURNDATE-ISSUEDATE>15;
	
	F_RNO ISSUE.RNO%TYPE;
	F_BOOKNO ISSUE.BOOKNO%TYPE;
	F_ISSUEDATE ISSUE.ISSUEDATE%TYPE;
	F_RETURNDATE ISSUE.RETURNDATE%TYPE;

	DAYS FINE.TOTALDAY%TYPE;
	CHARGE FINE.FINED%TYPE;
BEGIN
	OPEN P12_CURSOR;
	LOOP
	FETCH P12_CURSOR INTO F_RNO,F_BOOKNO,
	F_ISSUEDATE,F_RETURNDATE;
	EXIT WHEN P12_CURSOR%NOTFOUND;

	DAYS:=F_RETURNDATE-F_ISSUEDATE-15;

	IF(DAYS<=7) THEN
	CHARGE:=DAYS*1;
	ELSIF(DAYS<=15) THEN
	CHARGE:=DAYS*2;
	ELSE
	CHARGE:=DAYS*5;
	END IF;

	INSERT INTO FINE
	VALUES(F_RNO,F_BOOKNO,DAYS,CHARGE);
	
	END LOOP;
END;

	

