DECLARE
	CURSOR P11_CURSOR
	IS SELECT SID,SUM(QTY) AS TOT
	FROM TRANSACTION
	GROUP BY SID
	ORDER BY TOT DESC;

	F_SID TRANSACTION.SID%TYPE;
	F_TOT NUMBER(2);
	
	F_SNAME SUPPLYMASTER.SNAME%TYPE;
	F_ADDRESS SUPPLYMASTER.ADDRESS%TYPE;
	
BEGIN
	OPEN  P11_CURSOR;
	
	FETCH P11_CURSOR INTO F_SID,F_TOT;

	SELECT SNAME,ADDRESS INTO F_SNAME,F_ADDRESS
	FROM SUPPLYMASTER WHERE SID=F_SID;
	DBMS_OUTPUT.PUT_LINE(F_SNAME||'	'||F_SID||'		'||F_ADDRESS);
END;